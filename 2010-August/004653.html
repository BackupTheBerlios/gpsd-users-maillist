<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Gpsd-users] gpsd sync to ntpd under large offset conditions
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/gpsd-users/2010-August/index.html" >
   <LINK REL="made" HREF="mailto:gpsd-users%40lists.berlios.de?Subject=Re%3A%20%5BGpsd-users%5D%20gpsd%20sync%20to%20ntpd%20under%20large%20offset%20conditions&In-Reply-To=%3C4C77DD2F.8070706%40kera.name%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004652.html">
   <LINK REL="Next"  HREF="004655.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gpsd-users] gpsd sync to ntpd under large offset conditions</H1>
    <B>Tomalak Geret'kal</B> 
    <A HREF="mailto:gpsd-users%40lists.berlios.de?Subject=Re%3A%20%5BGpsd-users%5D%20gpsd%20sync%20to%20ntpd%20under%20large%20offset%20conditions&In-Reply-To=%3C4C77DD2F.8070706%40kera.name%3E"
       TITLE="[Gpsd-users] gpsd sync to ntpd under large offset conditions">tom at kera.name
       </A><BR>
    <I>Fri Aug 27 17:43:43 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004652.html">[Gpsd-users] gpsd and Opensuse 11.3 --&gt; first solution
</A></li>
        <LI>Next message: <A HREF="004655.html">[Gpsd-users] gpsd sync to ntpd under large offset conditions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4653">[ date ]</a>
              <a href="thread.html#4653">[ thread ]</a>
              <a href="subject.html#4653">[ subject ]</a>
              <a href="author.html#4653">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi!

I'm running gpsd and ntpd on an embedded platform. The 
machine may be deployed in the field where NTP servers are 
inaccessible, and the machine may boot with a wildly 
inaccurate hardware clock.

When the machine's time/date is at least vaguely correct, 
gpsd is successfully throwing time sync to ntpd via SHM. 
This is functioning. I have also done `tinker panic 0` in 
ntp which works for making ntpd ignore large time offsets, 
and have proved with normal NTP servers that ntpd is no 
longer bothered by large time offsets.

Unfortunately, gpsd/SHM/ntpd is still ignoring my gpsd/SHM 
time source when the machine's RTC is highly offset from the 
GPS-reported time. I've found code in the gpsd source that 
writes to the syslog that the [gps-reported] &quot;date is more 
than a year in the future&quot; but can't find any logic in gpsd 
that would go on to prevent the time being used in this case.

Ideally I'd like to make it so that gpsd will always provide 
time sync to ntpd, regardless of the size of the offset, as 
I have set ntp up to happen with normal sources.

Any thoughts? :D

Best regards,
Tom

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004652.html">[Gpsd-users] gpsd and Opensuse 11.3 --&gt; first solution
</A></li>
	<LI>Next message: <A HREF="004655.html">[Gpsd-users] gpsd sync to ntpd under large offset conditions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4653">[ date ]</a>
              <a href="thread.html#4653">[ thread ]</a>
              <a href="subject.html#4653">[ subject ]</a>
              <a href="author.html#4653">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/gpsd-users">More information about the Gpsd-users
mailing list</a><br>
</body></html>
